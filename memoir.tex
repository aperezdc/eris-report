% vim:ft=tex:
%
\documentclass[a4paper,
	fontsize=12pt,
	titlepage=firstiscover,
	chapterprefix=true,
	appendixprefix=true,
	headings=big,
	headsepline,
	toc=bibliographynumbered,
	twoside]{scrbook}

\usepackage[english]{babel}
\usepackage{hyphenat}
\usepackage{varioref}

% Graphics support
\usepackage{xcolor}
\usepackage{dirtree}
\usepackage{calc}
\usepackage{tikz}
\usetikzlibrary{arrows,shapes,fit,shadows,positioning,chains}

\definecolor{grey}{rgb}{0.5, 0.5, 0.5}
\definecolor{lightgrey}{rgb}{0.95, 0.95, 0.95}
\definecolor{grassgreen}{rgb}{0.1, 0.85, 0.2}
\definecolor{fadedbrown}{rgb}{0.85, 0.1, 0.1}
\definecolor{darkmagenta}{rgb}{0.65, 0.0, 0.65}
\definecolor{lightblue}{rgb}{0.5, 0.75, 1.0}

% \def\checkmark{\tikz\fill (0,.35) -- (.25,0) -- (1,.7) -- (.25,.15) -- cycle;}
\def\checkmark{\tikz\fill
	(0, 1) -- (1, 0) -- (2.5, 1.5) -- (1, 0.5) -- cycle;}

\def\foldersymbol{\tikz\fill[scale=0.25]
  (0, 0) -- (1.7, 0) -- (1.7, 1) -- (1, 1) --
  (0.85, 1.25) -- (0.15, 1.25) -- (0, 1) -- cycle;}
\newcommand\inlinesymbol[1]{\resizebox{\widthof{#1}*\ratio{\widthof{x}}{\widthof{\normalsize x}}}{!}{#1}}

\newcommand\DtFolder[1]{{\inlinesymbol{\color{grey}\foldersymbol}} #1}
% \newcommand\Tick{\inlinesymbol\checkmark}
\newcommand\Tick{ $\star$ }

% Make a TOC in the generated PDF
\usepackage[pdfstartview=FitH,
	unicode=true,
	linktoc=all]{hyperref}
\usepackage[open]{bookmark}
\bookmarksetup{color=blue}
% \usepackage{minitoc}
\usepackage[acronym,xindy,toc]{glossaries}
\makeglossaries
\glossarystyle{altlistgroup}
\input{glossary}

% Fonts
\usepackage[OT1]{fontenc}
\usepackage{fontspec}
\defaultfontfeatures{Ligatures=TeX}

% \setsansfont{Alegreya Sans}[SmallCapsFont=* SC]
% \setmainfont{Alegreya}[SmallCapsFont=* SC]

\setmainfont{Andada}[SmallCapsFont=* SC]
% \setsansfont{Overpass}

% \setmainfont{PermianSlabSerifTypeface}
% \setmainfont{PermianSerifTypeface}
% \setsansfont{PermianSansTypeface}

% \setsansfont{Carlito}
% \setsansfont{Istok}
% \setsansfont{Lato}

% \setmainfont{Bitter}
% \setmainfont{Brill}
% \setmainfont{Libre Caslon Text}

\newfontfamily\RlwLight[
	ItalicFont     = {Raleway ExtraLight Italic},
	BoldFont       = {Raleway Light},
	BoldItalicFont = {Raleway Light Italic}]{Raleway ExtraLight}
\setsansfont{Raleway}

% \setmonofont[Scale=MatchLowercase]{Input Mono}
% \setmonofont[Scale=MatchLowercase]{Source Code Pro}
% \setmonofont[Scale=MatchUppercase]{PragmataPro}
% \setmonofont[Scale=MatchLowercase]{Akkurat-Mono}
% \setmonofont[Scale=MatchUppercase]{Inconsolatazi4}
% \setmonofont[Scale=MatchLowercase]{Inconsolatazi4}

% \setmonofont[Scale=MatchLowercase]{PT Mono}
% \setmonofont[Scale=MatchLowercase]{Fira Code}
% \setmonofont[Scale=MatchUppercase]{Input Mono Condensed}
% \setmonofont[Scale=MatchUppercase]{Luxi Mono}
% \setmonofont{Input Mono Condensed}

\newfontfamily\InpLight[
	ItalicFont = {Input Mono Narrow Light Italic},
	BoldFont   = {Input Mono Narrow Regular},
	BoldItalicFont = {Input Mono Narrow Italic},
]{Input Mono narrow Light}

\setmonofont[Scale=MatchLowercase]{Input Mono Narrow Light}


\usepackage{setspace}
\onehalfspacing
% \doublespacing
\parskip=6pt
\parindent=10pt

\usepackage{scrlayer-scrpage}
% Header:
%   Inner: section numbering and title
%   Outer: chapter number
\ohead{Chapter \thechapter}
\chead{}
\ihead{\rightmark}
% Footer:
%   Center: page number
\cfoot{\thepage}
\ifoot{}
\ofoot{}

\setkomafont{chapterprefix}{\RlwLight\Large}
\setkomafont{chapter}{\RlwLight\bfseries\Huge}

\usepackage{booktabs}

% Pretty code listings
\usepackage{scrhack}  % Needed to use Minted w/KOMA-Script
\usepackage{minted}
\setminted{
  autogobble   = true,
  breaklines   = true,
  codetagify   = true,
  encoding     = utf-8,
  outencoding  = utf-8,
  frame        = leftline,
  framerule    = 5pt,
  framesep     = 0.65em,
  xleftmargin  = 1em,
  xrightmargin = 1em,
  rulecolor    = \color{lightgrey},
}
\newmintinline[Mc]{c}{}
\newminted{c}{
  fontsize = \small,
  baselinestretch = 1.0,
}
\newminted{lua}{
  fontsize = \small,
  baselinestretch = 1.0,
}


\include{hyphenation}


\newcommand\PfcTitle[0]{%
Automatic bridging of native code to Lua
using existing debugging information\relax}
\newcommand\PfcAuthor[0]{%
Adrián Pérez de Castro\relax}
\newcommand\PfcDirector[0]{%
Laura Milagros Castro Souto\relax}


\title{\PfcTitle}
\author{\PfcAuthor}

\begin{document}
% \dominitoc
\pagestyle{empty}

\begin{titlepage}
	\begin{center}
        \vspace{7cm}
        % Logo
        \begin{tikzpicture}[y=0.80pt, x=0.8pt,yscale=-1, inner sep=0pt, outer sep=0pt, scale=0.2]
          \path[fill=magenta,nonzero rule] (220.7188,106.4062) -- (382.3633,33.4609) ..
            controls (341.6836,12.8594) and (284.3281,-0.0039) .. (220.7227,-0.0039) ..
            controls (157.1016,-0.0039) and (99.7461,12.8594) .. (59.0742,33.4609) --
            (220.7188,106.4062);
          \path[fill=magenta,nonzero rule] (440.9648,89.9531) .. controls
            (436.4648,76.9375) and (427.1289,64.7109) .. (413.8828,53.7188) --
            (233.1914,105.5312) -- (440.9648,89.9531);
            \path[fill=magenta,nonzero rule] (414.9375,161.0898) .. controls
              (428.0547,149.9570) and (437.2305,137.6055) .. (441.4414,124.4531) --
              (232.9805,109.8984) -- (414.9375,161.0898);
            \path[fill=magenta,nonzero rule] (220.7305,109.2188) -- (57.9609,181.6680) ..
              controls (98.6992,202.6055) and (156.5195,215.6992) .. (220.7227,215.6992) ..
              controls (284.9102,215.6992) and (342.7344,202.6055) .. (383.4805,181.6680) --
              (220.7305,109.2188);
          \path[fill=magenta,nonzero rule] (0.0000,124.4531) .. controls (4.2109,137.6055)
            and (13.3867,149.9570) .. (26.4961,161.0898) -- (208.4492,109.8984) --
            (0.0000,124.4531);
          \path[fill=magenta,nonzero rule] (208.2422,105.5312) -- (27.5625,53.7109) ..
            controls (14.3164,64.7070) and (4.9766,76.9336) .. (0.4727,89.9531) --
            (208.2422,105.5312);
        \end{tikzpicture}

		{\Large\textbf{Facultade de Informática \\
			Universidade da Coruña}} \\
		{\large\textit{Departamento de Computación}}
		\vspace{1cm}

		{\large\textsc{Proyecto de Fin de Carrera \\
			Ingeniería Informática}}
		\vspace{1cm}

		{\Large\textbf{\PfcTitle}}
	\end{center}

	\vfill

	\begin{flushright}
		\begin{tabular}{ll}
			{\large\textbf{Student:}}  & {\large\PfcAuthor} \\
			{\large\textbf{Director:}} & {\large\PfcDirector} \\
			{\large\textbf{Date:}}     & {\large\today}
		\end{tabular}
	\end{flushright}
\end{titlepage}

\frontmatter

% General information
\cleardoublepage
\chapter*{General Information}

\vspace{1cm}
\begin{tabular}{p{0.35\textwidth}p{0.65\textwidth}}
	\textbf{\textit{Title:}} & \textbf{\PfcTitle} \vspace{0.5cm} \\
	\textit{Project Kind:} & Classic engineering project. \vspace{0.5cm} \\
	\textit{Student:}      & \PfcAuthor \vspace{0.5cm} \\
	\textit{Director:}     & \PfcDirector \vspace{0.5cm} \\
	\textit{Tribunal members:} & \vspace{3cm} \\
	\textit{Resevere members:} & \vspace{3cm} \\
	\textit{Reading date:} & \vspace{0.5cm}   \\
	\textit{Mark:} & \\
\end{tabular}

% Certificate
\cleardoublepage
\include{certificate}

% Dedication
\cleardoublepage
\begin{minipage}[t][6cm][l]{\textwidth}
	\vspace{10cm}
	\begin{flushright}
		\textit{Do it, or don't, but don't try.}
	\end{flushright}
\end{minipage}

% Acknowledgements
\cleardoublepage
\chapter*{Acknowledgements}

Last, but not least, I would like to thank my “adoptive” family, who have
kindly accepted myself as one more of them, and that have been of invaluable
support. Their appreciation of knowledge is something I am willing to pass
down to upcoming generations.


% Summary
\cleardoublepage
\include{summary}

% Keywords
\cleardoublepage
\chapter*{Keywords}
\begin{itemize}
	\item Automatic binding generation.
	\item \gls{ELF}.
	\item \gls{DWARF}.
	\item Debugging information.
	\item Lua programming language.
	\item \gls{FFI}.
	% \item JIT code generation.
\end{itemize}

% Indexes
\cleardoublepage
\tableofcontents
\listoffigures
\listoftables
\listoflistings

\mainmatter
\pagestyle{scrheadings}
\include{introduction}
\include{contextualization}
\include{design}
\include{implementation}
\include{conclusions}

\backmatter
\cleardoublepage
\printglossaries

\include{bibliography}

\end{document}
